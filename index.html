<script>
  function startListening() {
    const output = document.getElementById("output");
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    if (!SpeechRecognition) {
      output.textContent = "Speech Recognition not supported in this browser.";
      return;
    }

    const recognition = new SpeechRecognition();
recognition.maxAlternatives = 1;
recognition.continuous = true;  // keeps listening until you stop it manually
recognition.interimResults = true;

    recognition.lang = "en-US";
    recognition.interimResults = true; // show partial results
    recognition.continuous = false; // listen once, stop after speech

    output.textContent = "Listening... üéôÔ∏è";

    recognition.start();

    recognition.onresult = function (event) {
      let transcript = "";
      for (let i = event.resultIndex; i < event.results.length; i++) {
        transcript += event.results[i][0].transcript;
      }
      output.textContent = transcript;
    };

    recognition.onerror = function (event) {
      if(event.error === "no-speech") {
        output.textContent = "No speech detected. Please try again.";
      } else {
        output.textContent = "Error: " + event.error;
      }
    };

    recognition.onend = function() {
      // Automatically restart listening if needed
      // recognition.start();
    };
  }
</script>
